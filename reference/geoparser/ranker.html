<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>geoparser.ranking. Ranker &mdash; T-Res 0.1.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="geoparser.recogniser.Recogniser" href="recogniser.html" />
    <link rel="prev" title="geoparser.linking.Linker" href="linker.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> T-Res
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html"><code class="docutils literal notranslate"><span class="pre">geoparser</span></code> module</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="linker.html"><code class="docutils literal notranslate"><span class="pre">geoparser.linking.Linker</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">geoparser.ranking.</span> <span class="pre">Ranker</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="recogniser.html"><code class="docutils literal notranslate"><span class="pre">geoparser.recogniser.Recogniser</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="pipeline.html"><code class="docutils literal notranslate"><span class="pre">geoparser.pipeline.Pipeline</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html"><code class="docutils literal notranslate"><span class="pre">utils</span></code> module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../t-res-api/index.html">Running T-Res as API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../other-files/index.html">Other files in repository</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">T-Res</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Reference</a> &raquo;</li>
          <li><a href="index.html"><code class="docutils literal notranslate"><span class="pre">geoparser</span></code> module</a> &raquo;</li>
      <li><code class="docutils literal notranslate"><span class="pre">geoparser.ranking.</span> <span class="pre">Ranker</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/reference/geoparser/ranker.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="geoparser-ranking-ranker">
<h1><code class="docutils literal notranslate"><span class="pre">geoparser.ranking.</span> <span class="pre">Ranker</span></code><a class="headerlink" href="#geoparser-ranking-ranker" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="geoparser.ranking.Ranker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">geoparser.ranking.</span></span><span class="sig-name descname"><span class="pre">Ranker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">'perfectmatch'</span><span class="p"><span class="pre">,</span> </span><span class="pre">'partialmatch'</span><span class="p"><span class="pre">,</span> </span><span class="pre">'levenshtein'</span><span class="p"><span class="pre">,</span> </span><span class="pre">'deezymatch'</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resources_path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mentions_to_wikidata</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wikidata_to_mentions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strvar_parameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{'max_len':</span> <span class="pre">15,</span> <span class="pre">'min_len':</span> <span class="pre">5,</span> <span class="pre">'ocr_threshold':</span> <span class="pre">60,</span> <span class="pre">'overwrite_dataset':</span> <span class="pre">False,</span> <span class="pre">'top_threshold':</span> <span class="pre">85,</span> <span class="pre">'w2v_ocr_model':</span> <span class="pre">'w2v_*_news',</span> <span class="pre">'w2v_ocr_path':</span> <span class="pre">'/home/runner/work/T-Res/T-Res/docs/resources/models/w2v'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deezy_parameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{'dm_cands':</span> <span class="pre">'wkdtalts',</span> <span class="pre">'dm_model':</span> <span class="pre">'w2v_ocr',</span> <span class="pre">'dm_output':</span> <span class="pre">'deezymatch_on_the_fly',</span> <span class="pre">'dm_path':</span> <span class="pre">'/home/runner/work/T-Res/T-Res/docs/resources/deezymatch',</span> <span class="pre">'do_test':</span> <span class="pre">False,</span> <span class="pre">'num_candidates':</span> <span class="pre">1,</span> <span class="pre">'overwrite_training':</span> <span class="pre">False,</span> <span class="pre">'ranking_metric':</span> <span class="pre">'faiss',</span> <span class="pre">'selection_threshold':</span> <span class="pre">50,</span> <span class="pre">'verbose':</span> <span class="pre">False}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">already_collected_cands</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#geoparser.ranking.Ranker" title="Permalink to this definition"></a></dt>
<dd><p>The Ranker class implements a system for candidate selection through string
variation ranking. It provides methods to select candidates based on different
matching approaches, such as perfect match, partial match, Levenshtein distance,
and DeezyMatch. The class also handles loading and processing of resources
related to candidate selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – The candidate selection and ranking method to use.</p></li>
<li><p><strong>resources_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – Relative path to the resources directory
(containing Wikidata resources).</p></li>
<li><p><strong>mentions_to_wikidata</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>, </em><em>optional</em>) – An empty dictionary which
will store the mapping between mentions and Wikidata IDs,
which will be loaded through the
<a class="reference internal" href="#geoparser.ranking.Ranker.load_resources" title="geoparser.ranking.Ranker.load_resources"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_resources()</span></code></a> method.</p></li>
<li><p><strong>wikidata_to_mentions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>, </em><em>optional</em>) – An empty dictionary which
will store the mapping between Wikidata IDs and mentions,
which will be loaded through the
<a class="reference internal" href="#geoparser.ranking.Ranker.load_resources" title="geoparser.ranking.Ranker.load_resources"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load_resources()</span></code></a> method.</p></li>
<li><p><strong>strvar_parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>, </em><em>optional</em>) – Dictionary of string variation
parameters required to create a DeezyMatch training dataset.
For the default settings, see Notes below.</p></li>
<li><p><strong>deezy_parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>, </em><em>optional</em>) – Dictionary of DeezyMatch parameters
for model training. For the default settings, see Notes below.</p></li>
<li><p><strong>already_collected_cands</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a><em>, </em><em>optional</em>) – Dictionary of already
collected candidates. Defaults to <code class="docutils literal notranslate"><span class="pre">dict()</span></code> (an empty dictionary).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a Ranker object:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ranker</span> <span class="o">=</span> <span class="n">Ranker</span><span class="p">(</span>
<span class="go">        method=&quot;perfectmatch&quot;,</span>
<span class="go">        resources_path=&quot;/path/to/resources/&quot;,</span>
<span class="go">    )</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load resources</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ranker</span><span class="o">.</span><span class="n">mentions_to_wikidata</span> <span class="o">=</span> <span class="n">ranker</span><span class="o">.</span><span class="n">load_resources</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Train the ranker (if applicable)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ranker</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform candidate selection</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;Paraguay&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">candidates</span><span class="p">,</span> <span class="n">already_collected</span> <span class="o">=</span> <span class="n">ranker</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">queries</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Find candidates for mentions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mentions</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;mention&#39;</span><span class="p">:</span> <span class="s1">&#39;London&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;mention&#39;</span><span class="p">:</span> <span class="s1">&#39;Paraguay&#39;</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mention_candidates</span><span class="p">,</span> <span class="n">mention_already_collected</span> <span class="o">=</span> <span class="n">ranker</span><span class="o">.</span><span class="n">find_candidates</span><span class="p">(</span><span class="n">mentions</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print the results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Candidate Selection Results:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">already_collected</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Find Candidates Results:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mention_candidates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mention_already_collected</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>The default settings for <code class="docutils literal notranslate"><span class="pre">strvar_parameters</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">strvar_parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Parameters to create the string pair dataset:</span>
    <span class="s2">&quot;ocr_threshold&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
    <span class="s2">&quot;top_threshold&quot;</span><span class="p">:</span> <span class="mi">85</span><span class="p">,</span>
    <span class="s2">&quot;min_len&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;max_len&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s2">&quot;w2v_ocr_path&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;resources/models/w2v/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()),</span>
    <span class="s2">&quot;w2v_ocr_model&quot;</span><span class="p">:</span> <span class="s2">&quot;w2v_*_news&quot;</span><span class="p">,</span>
    <span class="s2">&quot;overwrite_dataset&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>The default settings for <code class="docutils literal notranslate"><span class="pre">deezy_parameters</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">deezy_parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;dm_path&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;resources/deezymatch/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()),</span>
    <span class="s2">&quot;dm_cands&quot;</span><span class="p">:</span> <span class="s2">&quot;wkdtalts&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dm_model&quot;</span><span class="p">:</span> <span class="s2">&quot;w2v_ocr&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dm_output&quot;</span><span class="p">:</span> <span class="s2">&quot;deezymatch_on_the_fly&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ranking_metric&quot;</span><span class="p">:</span> <span class="s2">&quot;faiss&quot;</span><span class="p">,</span>
    <span class="s2">&quot;selection_threshold&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;num_candidates&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;verbose&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;overwrite_training&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s2">&quot;do_test&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="geoparser.ranking.Ranker.check_if_contained">
<span class="sig-name descname"><span class="pre">check_if_contained</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.1.0.dev0+1296.gd2f05c2d23)"><span class="pre">pandas.core.series.Series</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></span><a class="headerlink" href="#geoparser.ranking.Ranker.check_if_contained" title="Permalink to this definition"></a></dt>
<dd><p>Returns the amount of overlap, if a mention is contained within a row
in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – A mention identified in a text.</p></li>
<li><p><strong>row</strong> (<em>Series</em>) – A pandas Series representing a row in the dataset
with a “mentions” column, corresponding to a mention in the
knowledge base.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The match score indicating the degree of containment,
ranging from <code class="docutils literal notranslate"><span class="pre">0.0</span></code> to <code class="docutils literal notranslate"><span class="pre">1.0</span></code> (perfect match).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ranker</span> <span class="o">=</span> <span class="n">Ranker</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;apple&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;mentions&#39;</span><span class="p">:</span> <span class="s1">&#39;Delicious apple&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_score</span> <span class="o">=</span> <span class="n">ranker</span><span class="o">.</span><span class="n">check_if_contained</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">match_score</span><span class="p">)</span>
<span class="go">0.3333333333333333</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geoparser.ranking.Ranker.damlev_dist">
<span class="sig-name descname"><span class="pre">damlev_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.1.0.dev0+1296.gd2f05c2d23)"><span class="pre">pandas.core.series.Series</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></span><a class="headerlink" href="#geoparser.ranking.Ranker.damlev_dist" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Damerau-Levenshtein distance between a mention and a row
in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – A mention identified in a text.</p></li>
<li><p><strong>row</strong> (<em>Series</em>) – A pandas Series representing a row in the dataset
with a “mentions” column, corresponding to an alternate name
of an etity in the knowledge base.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The similarity score between the query and the row, ranging
from <code class="docutils literal notranslate"><span class="pre">0.0</span></code> to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method computes the Damerau-Levenshtein distance between the
lowercase versions of a mention and the “mentions” column value in
the given row.</p>
<p>The distance is then normalized to a similarity score by
subtracting it from <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p>
</div>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ranker</span> <span class="o">=</span> <span class="n">Ranker</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;apple&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;mentions&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">similarity</span> <span class="o">=</span> <span class="n">ranker</span><span class="o">.</span><span class="n">damlev_dist</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">similarity</span><span class="p">)</span>
<span class="go">0.1666666865348816</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geoparser.ranking.Ranker.deezy_on_the_fly">
<span class="sig-name descname"><span class="pre">deezy_on_the_fly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#geoparser.ranking.Ranker.deezy_on_the_fly" title="Permalink to this definition"></a></dt>
<dd><p>Perform DeezyMatch (a deep neural network approach to fuzzy string
matching) on-the-fly for a list of given mentions (<code class="docutils literal notranslate"><span class="pre">queries</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>queries</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – A list of mentions (strings) identified in a text
to match.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A tuple containing two dictionaries:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The first dictionary maps each mention to its candidate
list, where the candidate list is a dictionary with the
mention variations as keys and their match scores as values.</p></li>
<li><p>The second dictionary stores the already collected
candidates for each mention. It is an updated version of the
Ranker’s <code class="docutils literal notranslate"><span class="pre">already_collected_cands</span></code> attribute.</p></li>
</ol>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ranker</span> <span class="o">=</span> <span class="n">Ranker</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ranker</span><span class="o">.</span><span class="n">mentions_to_wikidata</span> <span class="o">=</span> <span class="n">ranker</span><span class="o">.</span><span class="n">load_resources</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;Shefrield&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">candidates</span><span class="p">,</span> <span class="n">already_collected</span> <span class="o">=</span> <span class="n">ranker</span><span class="o">.</span><span class="n">deezy_on_the_fly</span><span class="p">(</span><span class="n">queries</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
<span class="go">{&#39;London&#39;: {&#39;London&#39;: 1.0}, &#39;Shefrield&#39;: {&#39;Sheffield&#39;: 0.03382000000000005}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">already_collected</span><span class="p">)</span>
<span class="go">{&#39;London&#39;: {&#39;London&#39;: 1.0}, &#39;Shefrield&#39;: {&#39;Sheffield&#39;: 0.03382000000000005}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method performs DeezyMatch on-the-fly for each mention in a
given list of mentions identified in a text. If a query has
already been matched perfectly, it skips the fuzzy matching
process for that query. For the remaining queries,
it uses the DeezyMatch model to generate candidates and ranks them
based on the specified ranking metric and selection threshold,
provided when initialising the <a class="reference internal" href="#geoparser.ranking.Ranker" title="geoparser.ranking.Ranker"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Ranker()</span></code></a>
object.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geoparser.ranking.Ranker.find_candidates">
<span class="sig-name descname"><span class="pre">find_candidates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mentions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#geoparser.ranking.Ranker.find_candidates" title="Permalink to this definition"></a></dt>
<dd><p>Find candidates for the given mentions using the selected ranking
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mentions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – A list of predicted mentions as dictionaries.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A tuple containing two dictionaries:</p>
<ol class="arabic">
<li><p>The first dictionary maps each original mention to a
sub-dictionary, where the sub-dictionary maps the mention
variations to a sub-sub-dictionary with two keys: <code class="docutils literal notranslate"><span class="pre">&quot;Score&quot;</span></code>
(the string matching similarity score) and <code class="docutils literal notranslate"><span class="pre">&quot;Candidates&quot;</span></code>
(a dictionary containing the Wikidata candidates, where the
key is the Wikidata ID and value is the the relative mention-
to-wikidata frequency).</p></li>
<li><p>The second dictionary stores the already collected candidates
for each query.</p>
<p>The variation is found by the candidate ranker in the knowledge
base, and for each variation, the candidate ranking score and
the candidates from Wikidata are provided. E.g. for mention
“Guadaloupe” in sentence “sn83030483-1790-03-31-a-i0004_1”, the
candidates will show as follows:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Guadaloupe&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;Candidates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Q17012&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.003935458480913026</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Q3153836&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">0.07407407407407407</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method takes a list of mentions and finds candidates for each
mention using the selected ranking method. It first extracts the
queries from the mentions and then calls the appropriate method
based on the ranking method chosen when initialising the
<a class="reference internal" href="#geoparser.ranking.Ranker" title="geoparser.ranking.Ranker"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Ranker()</span></code></a> object.</p>
<p>The method returns a dictionary that maps each original mention to
a sub-dictionary containing the mention variations as keys and
their corresponding Wikidata match scores as values.</p>
<p>Additionally, it updates the already collected candidates
dictionary (the Ranker object’s <code class="docutils literal notranslate"><span class="pre">already_collected_cands</span></code>
attribute).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geoparser.ranking.Ranker.load_resources">
<span class="sig-name descname"><span class="pre">load_resources</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a></span></span><a class="headerlink" href="#geoparser.ranking.Ranker.load_resources" title="Permalink to this definition"></a></dt>
<dd><p>Load the ranker resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The loaded mentions-to-wikidata dictionary, which maps a
mention (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;London&quot;</span></code>) to the Wikidata entities that are
referred to by this mention on Wikipedia (e.g. <code class="docutils literal notranslate"><span class="pre">Q84</span></code>,
<code class="docutils literal notranslate"><span class="pre">Q2477346</span></code>). The data also includes, for each entity, their
normalized “relevance”, i.e. number of in-links across Wikipedia.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method loads the mentions-to-wikidata and
wikidata-to-mentions dictionaries from the resources directory,
specified when initialising the
<a class="reference internal" href="#geoparser.ranking.Ranker" title="geoparser.ranking.Ranker"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Ranker()</span></code></a>. They are required for
performing candidate selection and ranking.</p>
<p>It filters the dictionaries to remove noise and updates the class
attributes accordingly.</p>
<p>The method also initialises <code class="docutils literal notranslate"><span class="pre">pandarallel</span></code> if needed by the
candidate ranking method (if the <code class="docutils literal notranslate"><span class="pre">method</span></code> set in the initialiser
of the <code class="docutils literal notranslate"><span class="pre">Ranker</span></code> was set to “partialmatch” or “levenshtein”).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geoparser.ranking.Ranker.partial_match">
<span class="sig-name descname"><span class="pre">partial_match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damlev</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#geoparser.ranking.Ranker.partial_match" title="Permalink to this definition"></a></dt>
<dd><p>Perform partial matching for a list of given mentions (<code class="docutils literal notranslate"><span class="pre">queries</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>queries</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – A list of mentions (strings) identified in a text
to match.</p></li>
<li><p><strong>damlev</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – A flag indicating whether to use the
Damerau-Levenshtein distance for matching (True) or
containment-based matching (False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A tuple containing two dictionaries:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The first dictionary maps each mention to its candidate
list, where the candidate list is a dictionary with the
mention variations as keys and their match scores as values.</p></li>
<li><p>The second dictionary stores the already collected
candidates for each mention. It is an updated version of the
Ranker’s <code class="docutils literal notranslate"><span class="pre">already_collected_cands</span></code> attribute.</p></li>
</ol>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ranker</span> <span class="o">=</span> <span class="n">Ranker</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;banana&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">candidates</span><span class="p">,</span> <span class="n">already_collected</span> <span class="o">=</span> <span class="n">ranker</span><span class="o">.</span><span class="n">partial_match</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span> <span class="n">damlev</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
<span class="go">{&#39;apple&#39;: {&#39;apple&#39;: 1.0}, &#39;banana&#39;: {&#39;bananas&#39;: 0.5, &#39;banana split&#39;: 0.75}, &#39;orange&#39;: {&#39;orange&#39;: 1.0}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">already_collected</span><span class="p">)</span>
<span class="go">{&#39;apple&#39;: {&#39;apple&#39;: 1.0}, &#39;banana&#39;: {&#39;bananas&#39;: 0.5, &#39;banana split&#39;: 0.75}, &#39;orange&#39;: {&#39;orange&#39;: 1.0}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method performs partial matching for each mention in the given
list. If a mention has already been matched perfectly, it skips the
partial matching process for that mention. For the remaining
mentions, it calculates the match score based on the specified
partial matching method: Levenshtein distance or containment.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geoparser.ranking.Ranker.perfect_match">
<span class="sig-name descname"><span class="pre">perfect_match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#geoparser.ranking.Ranker.perfect_match" title="Permalink to this definition"></a></dt>
<dd><p>Perform perfect matching between a provided list of mentions
(<code class="docutils literal notranslate"><span class="pre">queries</span></code>) and the altnames in the knowledge base.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>queries</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – A list of mentions (string) identified in a text
to match.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A tuple containing two dictionaries:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The first dictionary maps each mention to its candidate
list, where the candidate list is a dictionary with the
mention itself as the key and a perfect match score of
<code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p></li>
<li><p>The second dictionary stores the already collected
candidates for each mention. It is an updated version of the
Ranker’s <code class="docutils literal notranslate"><span class="pre">already_collected_cands</span></code> attribute.</p></li>
</ol>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method checks if each mention has an exact match in the
mentions_to_wikidata dictionary. If a match is found, it assigns a
perfect match score of <code class="docutils literal notranslate"><span class="pre">1.0</span></code> to the mention. Otherwise, an empty
dictionary is assigned as the candidate list for the mention.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geoparser.ranking.Ranker.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">queries</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#geoparser.ranking.Ranker.run" title="Permalink to this definition"></a></dt>
<dd><p>Run the appropriate ranking method based on the specified method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>queries</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – A list of mentions (strings) identified in a text
to match.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing two dictionaries. The resulting dictionaries
will vary depending on the method set in the Ranker object.
See Notes below for further information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)">dict</a>]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">myranker</span> <span class="o">=</span> <span class="n">Ranker</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;perfectmatch&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myranker</span><span class="o">.</span><span class="n">mentions_to_wikidata</span> <span class="o">=</span> <span class="n">myranker</span><span class="o">.</span><span class="n">load_resources</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;Barcelona&#39;</span><span class="p">,</span> <span class="s1">&#39;Bologna&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">candidates</span><span class="p">,</span> <span class="n">already_collected</span> <span class="o">=</span> <span class="n">myranker</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">queries</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
<span class="go">{&#39;London&#39;: {&#39;London&#39;: 1.0}, &#39;Barcelona&#39;: {&#39;Barcelona&#39;: 1.0}, &#39;Bologna&#39;: {&#39;Bologna&#39;: 1.0}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">already_collected</span><span class="p">)</span>
<span class="go">{&#39;London&#39;: {&#39;London&#39;: 1.0}, &#39;Barcelona&#39;: {&#39;Barcelona&#39;: 1.0}, &#39;Bologna&#39;: {&#39;Bologna&#39;: 1.0}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method executes the appropriate ranking method based on the
<code class="docutils literal notranslate"><span class="pre">method</span></code> parameter, selected when initialising the
<a class="reference internal" href="#geoparser.ranking.Ranker" title="geoparser.ranking.Ranker"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Ranker()</span></code></a> object.</p>
<p>It delegates the execution to the corresponding method:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#geoparser.ranking.Ranker.perfect_match" title="geoparser.ranking.Ranker.perfect_match"><code class="xref py py-meth docutils literal notranslate"><span class="pre">perfect_match()</span></code></a></p></li>
<li><p><a class="reference internal" href="#geoparser.ranking.Ranker.partial_match" title="geoparser.ranking.Ranker.partial_match"><code class="xref py py-meth docutils literal notranslate"><span class="pre">partial_match()</span></code></a></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">levenshtein()</span></code></p></li>
<li><p><a class="reference internal" href="#geoparser.ranking.Ranker.deezy_on_the_fly" title="geoparser.ranking.Ranker.deezy_on_the_fly"><code class="xref py py-meth docutils literal notranslate"><span class="pre">deezy_on_the_fly()</span></code></a></p></li>
</ul>
<p>See the documentation of those methods for more details about
their processing if the provided mentions (<code class="docutils literal notranslate"><span class="pre">queries</span></code>).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geoparser.ranking.Ranker.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#geoparser.ranking.Ranker.train" title="Permalink to this definition"></a></dt>
<dd><p>Training a DeezyMatch model. The training will be skipped if the model
already exists and the <code class="docutils literal notranslate"><span class="pre">overwrite_training</span></code> key in the
<code class="docutils literal notranslate"><span class="pre">deezy_parameters</span></code> passed when initialising the
<a class="reference internal" href="#geoparser.ranking.Ranker" title="geoparser.ranking.Ranker"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Ranker()</span></code></a> object is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>. The
training will be run on test mode if the <code class="docutils literal notranslate"><span class="pre">do_test</span></code> key in the
<code class="docutils literal notranslate"><span class="pre">deezy_parameters</span></code> passed when initialising the
<a class="reference internal" href="#geoparser.ranking.Ranker" title="geoparser.ranking.Ranker"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Ranker()</span></code></a> object is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="linker.html" class="btn btn-neutral float-left" title="geoparser.linking.Linker" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="recogniser.html" class="btn btn-neutral float-right" title="geoparser.recogniser.Recogniser" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 Living with Machines.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>